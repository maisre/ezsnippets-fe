<div *ngIf="page" class="page-edit-container">
  <h2>Edit Page: {{ page.name || page.name || page.id }}</h2>

  <div class="page-info">
    <div *ngIf="page.name"><strong>Name:</strong> {{ page.name }}</div>
    <div *ngIf="page.siteName"><strong>Site Name:</strong> {{ page.siteName }}</div>
    <div *ngIf="page.description"><strong>Description:</strong> {{ page.description }}</div>
    <div><strong>AI Customized:</strong> {{ page.aiCustomized ? 'Yes' : 'No' }}</div>
    <div *ngIf="page.projectId"><strong>Project ID:</strong> {{ page.projectId }}</div>
  </div>

  <div class="drag-drop-container">
    <!-- Left side: Page Snippets -->
    <div class="snippet-list-container">
      <h3>Page Snippets</h3>
      <div
        cdkDropList
        id="page-snippets"
        [cdkDropListData]="pageSnippets"
        [cdkDropListConnectedTo]="['available-snippets']"
        (cdkDropListDropped)="drop($event)"
        class="snippet-list"
      >
        <div
          *ngFor="let snippet of pageSnippets; trackBy: trackBySnippetId"
          cdkDrag
          [cdkDragStartDelay]="0"
          [cdkDragBoundary]="'.page-edit-container'"
          class="snippet-item"
        >
          <div class="snippet-content">
            <img
              [src]="viewUrl + '/public/images/screenshots/' + snippet.id + '.png'"
              alt="Snippet screenshot"
              class="snippet-screenshot"
            />
            <span class="drag-handle">⋮⋮</span>
          </div>
        </div>
        <div *ngIf="pageSnippets.length === 0" class="empty-state">
          No snippets assigned to this page
        </div>
      </div>
    </div>

    <!-- Right side: Available Snippets -->
    <div class="snippet-list-container">
      <h3>Available Snippets</h3>
      <div
        cdkDropList
        id="available-snippets"
        [cdkDropListData]="availableSnippets"
        [cdkDropListConnectedTo]="['page-snippets']"
        (cdkDropListDropped)="drop($event)"
        class="snippet-list"
      >
        <div
          *ngFor="let snippet of availableSnippets; trackBy: trackBySnippetId"
          cdkDrag
          [cdkDragStartDelay]="0"
          [cdkDragBoundary]="'.page-edit-container'"
          class="snippet-item"
        >
          <div class="snippet-content">
            <img
              [src]="viewUrl + '/public/images/screenshots/' + snippet.id + '.png'"
              alt="Snippet screenshot"
              class="snippet-screenshot"
            />
            <span class="drag-handle">⋮⋮</span>
          </div>
        </div>
        <div *ngIf="availableSnippets.length === 0" class="empty-state">No available snippets</div>
      </div>
    </div>
  </div>

  <div class="actions">
    <button (click)="router.navigate(['/pages'])">Back to Pages</button>
  </div>
</div>

<div *ngIf="!page && pageId">
  <p>Loading page...</p>
</div>

<div *ngIf="!pageId">
  <p>No page ID provided</p>
  <button (click)="router.navigate(['/pages'])">Back to Pages</button>
</div>
